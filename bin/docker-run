#!/bin/bash
set -exu

WD="$(pwd)"

IMAGE="$(IMAGE_NAME=leihs-ui-runner STAGE=runner bin/docker-build | tail -1)"
test "$IMAGE"

docker run --rm -it \
  -v "${WD}/.storybook:/leihs-ui/.storybook" \
  -v "${WD}/bin:/leihs-ui/bin" \
  -v "${WD}/legacy:/leihs-ui/legacy" \
  -v "${WD}/public:/leihs-ui/public" \
  -v "${WD}/src:/leihs-ui/src" \
  -v "${WD}/static:/leihs-ui/static" \
  -v "${WD}/test:/leihs-ui/test" \
  -v "${WD}/package.json:/leihs-ui/package.json" \
  -v "${WD}/package-lock.json:/leihs-ui/package-lock.json" \
  -v "${WD}/webpack.config.js:/leihs-ui/webpack.config.js" \
  "$IMAGE" \
  $*